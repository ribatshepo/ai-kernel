apiVersion: v1
kind: ConfigMap
metadata:
  name: neo4j-config
  namespace: aikernel-data
  labels:
    app: neo4j
    component: graph-database
data:
  NEO4J_ACCEPT_LICENSE_AGREEMENT: "yes"
  NEO4J_EDITION: "ENTERPRISE"

  # Causal Clustering Configuration
  NEO4J_causal__clustering_minimum__core__cluster__size__at__formation: "3"
  NEO4J_causal__clustering_minimum__core__cluster__size__at__runtime: "3"
  NEO4J_causal__clustering_initial__discovery__members: "neo4j-core-0.neo4j-core.aikernel-data.svc.cluster.local:5000,neo4j-core-1.neo4j-core.aikernel-data.svc.cluster.local:5000,neo4j-core-2.neo4j-core.aikernel-data.svc.cluster.local:5000"

  # Network Configuration
  NEO4J_dbms_default__listen__address: "0.0.0.0"
  NEO4J_dbms_connector_bolt_enabled: "true"
  NEO4J_dbms_connector_bolt_listen__address: "0.0.0.0:7687"
  NEO4J_dbms_connector_bolt_advertised__address: ":7687"
  NEO4J_dbms_connector_http_enabled: "true"
  NEO4J_dbms_connector_http_listen__address: "0.0.0.0:7474"
  NEO4J_dbms_connector_https_enabled: "true"
  NEO4J_dbms_connector_https_listen__address: "0.0.0.0:7473"

  # Memory Configuration
  NEO4J_dbms_memory_heap_initial__size: "2G"
  NEO4J_dbms_memory_heap_max__size: "4G"
  NEO4J_dbms_memory_pagecache_size: "2G"

  # Transaction Configuration
  NEO4J_dbms_transaction_timeout: "300s"
  NEO4J_dbms_transaction_concurrent_maximum: "1000"

  # Security Configuration
  NEO4J_dbms_security_procedures_unrestricted: "apoc.*,gds.*"
  NEO4J_dbms_security_procedures_allowlist: "apoc.*,gds.*"
  NEO4J_dbms_security_auth__enabled: "true"

  # Logging Configuration
  NEO4J_dbms_logs_debug_level: "INFO"
  NEO4J_metrics_enabled: "true"
  NEO4J_metrics_prometheus_enabled: "true"
  NEO4J_metrics_prometheus_endpoint: "0.0.0.0:2004"

  # Performance Tuning
  NEO4J_dbms_checkpoint_interval_time: "15m"
  NEO4J_dbms_checkpoint_interval_tx: "100000"
  NEO4J_dbms_recovery_fail__on__missing__files: "false"

  # Clustering
  NEO4J_causal__clustering_discovery__advertised__address: ":5000"
  NEO4J_causal__clustering_transaction__advertised__address: ":6000"
  NEO4J_causal__clustering_raft__advertised__address: ":7000"
  NEO4J_causal__clustering_discovery__listen__address: "0.0.0.0:5000"
  NEO4J_causal__clustering_transaction__listen__address: "0.0.0.0:6000"
  NEO4J_causal__clustering_raft__listen__address: "0.0.0.0:7000"

  # Plugins
  NEO4J_dbms_security_procedures_allowlist__apoc: "apoc.*"
  NEO4J_dbms_security_procedures_allowlist__gds: "gds.*"
